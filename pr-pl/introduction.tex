\section{Introduction}

\subsection{Projective Planes}

	\begin{fdef}[Incidence System]
		An \emph{incidence system} is a pair $(\mathcal{P},\mathcal{L})$, where $\mathcal{P}$ is a set and $\mathcal{L}$ is a set of subsets of $\mathcal{P}$. Elements of $\mathcal{P}$ are called \emph{points} and elements of $\mathcal{L}$ are called \emph{lines}. A line $\ell$ is said to be \emph{incident} on a point $p$ if $p \in \ell$.\\
	\end{fdef}

	\begin{fdef}[Partial Linear Space]
		An incidence system $(\mathcal{P},\mathcal{L})$ is said to be a \emph{partial linear space} if
		\begin{enumerate}
		 	\item for each $\ell \in \mathcal{L}$, $|\ell| \ge 2$.
		 	\item for distinct $x,y \in \mathcal{P}$, there is at most one $\ell \in \mathcal{L}$ such that $\{x,y\} \subseteq \mathcal{P}$.
		\end{enumerate}
	\end{fdef}

	\begin{fdef}[Linear Space]
		An incidence system $(\mathcal{P},\mathcal{L})$ is said to be a \emph{linear space} if
		\begin{enumerate}
		 	\item for each $\ell \in \mathcal{L}$, $|\ell| \ge 2$.
		 	\item for distinct $x,y \in \mathcal{P}$, there is a unique $\ell \in \mathcal{L}$ such that $\{x,y\} \subseteq \mathcal{P}$.
		\end{enumerate}
	\end{fdef}

	\begin{fdef}[Steiner 2-design]
		A \emph{Steiner 2-design} $(\mathcal{P},\mathcal{L})$ is a linear space wherein the cardinality of any line is the same and the same number of lines pass through any point.
	\end{fdef}

	If a Steiner 2-design has $P$ points on each line and $L$ lines through every point, it has a total of $LP - (L - 1)$ points and $L (LP-L+1) / P$ lines.

	\begin{fdef}[Dual]
		Given a partial linear space $\mathcal{X}=(\mathcal{P},\mathcal{L})$, the incidence system $\mathcal{X}^* = (\mathcal{P}^*,\mathcal{L}^*)$ is said to be its \emph{dual} if there exist bijections $f : \mathcal{P} \to \mathcal{L}^*$ and $g : \mathcal{L} \to \mathcal{P}^*$ such that for any $p \in \mathcal{P}, \ell \in \mathcal{L}$, $p \in \ell$ iff $g(\ell)\in f(p)$.	
	\end{fdef}
	We remark that the dual is unique up to isomorphism.

	\begin{fdef}[Projective Plane]
		An incidence system $\mathcal{X} = (\mathcal{P},\mathcal{L})$ is said to be a \emph{projective plane} if
		\begin{enumerate}
			\item $\mathcal{X}$ is a linear space.
			\item $\mathcal{X}^*$ is a linear space.
			\item For any distinct $\ell,\ell' \in \mathcal{L}$, there exists $p \in \mathcal{P}$ such that $p \not\in \ell \cup \ell'$. This condition is equivalent to asserting that for distinct $p,p' \in \mathcal{P}$, there exists $\ell \in \mathcal{L}$ such that $\{p,p'\} \cap \ell = \emptyset$.
		\end{enumerate}
	\end{fdef}

	% Henceforth, unless mentioned otherwise, denote by $\mathcal{X} = (\mathcal{P},\mathcal{L})$ a projective plane.
	Given distinct points $x_1,x_2$, we denote by $x_1 \lor x_2$ the (unique) line passing through $x_1$ and $x_2$. Similarly, given distinct lines $\ell_1,\ell_2$, we denote by $\ell_1 \land \ell_2$ the (unique) point in their intersection.

	\begin{fdef}
		Given a projective plane $\mathcal{X}$, fix a line $\ell$ and point $x$ not incident on $\ell$. The function defined by $y \mapsto x \lor y$ is one from the set of points in $\ell$ to the set of lines through $x$. Further, it has inverse $m \mapsto m \land \ell$ and is thus a bijection. These two bijections are referred to as \emph{perspectivities} on the projective plane.
	\end{fdef}

	Using perspectivities, the following may be shown.

	\begin{flem}
		Given a projective plane $\mathcal{X}$, there exists a number $n \ge 0$, known as the \emph{order} of $\mathcal{X}$, such that
		\begin{enumerate}
			\item any point is incident with exactly $n+1$ lines.
			\item any line contains exactly $n+1$ points.
			\item the total number of points is $n^2+n+1$.
			\item the total number of lines is $n^2+n+1$.
		\end{enumerate}
	\end{flem}

	One common example of a projective plane is $\PG(2,\F)$, the projective plane over field $\F$. This has point set $V_1$ equal to the set of all $1$-dimensional subspaces of $\F^3$ (as a vector space over $\F$), and line set $V_2$ equal to the set of all $2$-dimensional subspaces of $\F^3$, where we identify each such subspace with the set of all $1$-dimensional subspaces contained in it.\\
	In particular, $\PG(2,\F_q)$ (where $q$ is a prime power) is of order $q$.\\

	The second projective plane of interest is the \emph{free projective plane}. We define it using a sequence $(\mathcal{X}_n)$ of incidence systems. Define $\mathcal{X_1} = (\mathcal{P}_1,\mathcal{L}_1)$ by $\mathcal{P}_1 = [4]$, $\mathcal{L}_1 = \binom{\mathcal{P}_1}{2}$. Given $\mathcal{X}_n = (\mathcal{P}_n,\mathcal{L}_n)$, the next incidence system is defined by taking $\mathcal{X}_n$ then performing the following operations:
	\begin{enumerate}
		\item for each pair $\{\ell_1,\ell_2\}$ of lines in $\mathcal{X}_n$ which have no common point, introduce a new point $\ell_1 \land \ell_2$. This new point is incident with $\ell_1$, $\ell_2$ and no other line.
		\item for each pair $\{x_1,x_2\}$ of points in $\mathcal{X}_n$ which have no line in common, introduce a new line $x_1 \lor x_2$. This new line is incident on $x_1$, $x_2$ and no other point.
	\end{enumerate}
	Finally, define the free projective plane $\mathcal{X} = (\bigcup_{n=1}^\infty \mathcal{P}_n,\bigcup_{n=1}^\infty \mathcal{L}_n)$ as the ``limiting element'' of this sequence.\\
	The free projective plane is denoted $\mathcal{F}$.

	\begin{fdef}[Subplane]
		A projective plane $(\mathcal{P}',\mathcal{L}')$ is said to be a projective \emph{subplane} of projective plane $(\mathcal{P},\mathcal{L})$ if
		\[ \mathcal{L}' = \{ \ell \cap \mathcal{P}' : \ell \in \mathcal{L} \}. \]
	\end{fdef}

	\begin{fdef}
		A \emph{prime} projective plane is a projective plane that has no proper subplane.
	\end{fdef}
	For example, $\PG(2,\F)$ is prime if $\F$ is a prime field (such as $\Q$ or $\F_p$ for prime $p$). The free projective plane is prime as well.

	\begin{remark}
		We are interested in both prime projective planes and projective planes of prime order. Observe which one is being referred to in any sentence!
	\end{remark}

	\begin{fcon}
		\label{singhi-conj}
		The only examples of prime projective planes are the free projective plane and the projective planes over prime fields.
	\end{fcon}
	It turns out that any prime projective plane is a homomorphic image of $\mathcal{F}$.
	Consequently, it may be interesting to study the sequence $\mathcal{X}_n$ of projective planes involved in the definition of $\mathcal{F}$.\\

	For $q > 8$ that is a non-prime prime power (so $p^r$ for $r \ge 2$), there are constructions of projective planes of order $q$ which are not the field plane $\PG(2,\F_q)$. However, we have nothing similar for prime $q$.

	\begin{fcon}
		\label{cool-conj}
		Up to isomorphism, $\PG(2,\F_p)$ is the only projective plane of prime order $p$.
	\end{fcon}

	The two conjectures given do have some resemblance, but we have nothing concrete. In fact, it is not even known if a projective plane of prime order is necessarily a prime projective plane, or if a finite prime projective plane must have prime order.

	A stronger version of \Cref{singhi-conj} is the following, conjectured by H. Neumann.

	\begin{fcon}
		A finite projective plane has no subplane of order two if and only if it is isomorphic to $\PG(2,\F_q)$ for some odd prime power $q$. 
	\end{fcon}

\subsection{Coding Theory}

	\begin{fdef}
		Given an incidence system $\mathcal{X} = (\mathcal{P},\mathcal{L})$ and a field $\F$, we define the $p$-ary linear code $\mathcal{C}_\F(\mathcal{X})$ over $\F^\mathcal{P}$ as follows. Identify each line $\ell$ with the codeword in $\F^{\mathcal{P}}$ whose $x$th coordinate is $1$ if $x \in \ell$ and $0$ otherwise. $\mathcal{C}_\F(\mathcal{X})$ is then the space spanned by the codewords corresponding to the lines in $\mathcal{L}$.\\
		If $\F = \F_q$, we sometimes denote the above as $\mathcal{C}_q(\mathcal{X})$.
	\end{fdef}

	We call the code $\mathcal{X} = (\mathcal{P},\mathcal{L})$ \emph{trivial} at $q$ if $\mathcal{C}_q(\mathcal{X}) = \F^\mathcal{P}$. We often denote this code as $\mathcal{C}_\mathcal{X}$ or $\mathcal{C}_\mathcal{L}$ if $q$ is clear from context.

	\begin{ftheo}
		If $\pi$ is a projective plane of order $n$ and $q$ is a prime power that does not divide $n$, then $\mathcal{C}_q(\pi)$ is trivial.
	\end{ftheo}
	\begin{proof}
		For each $x \in \mathcal{P}$, consider the word $v_x$ formed by adding all the lines that pass through $x$. This word has $n+1$ in the $x$th coordinate and $1$ in all remaining coordinates. For distinct $x,y \in \mathcal{C}_p(\pi)$, the word $v_x - v_y$ is thus the vector that has $n$ in the $x$th coordinate, $-n$ in the $y$th coordinate, and all remaining coordinates are $0$. Since $q$ does not divide $n$, $n$ and $-n$ are nonzero in $\F_q$, and so $e_x - e_y$ lies in $\mathcal{C}_q(\pi)$. This implies that the dual $\textbf{1}^\top$ of the all $1$s vector is contained in $\mathcal{C}_q(\pi)$. If we manage to show that $\textbf{1}$ is contained in the code, we are done. 
		% adding all lines maybe, but that gives (n+1) 1, which may be zero if q | (n+1)?
	\end{proof}

	\begin{fdef}[Dual]
		Given a code $\mathcal{C}$ over $\F_q^\mathcal{P}$, its \emph{dual} is
		\[ \mathcal{C}^\top = \{ v \in \F_q^\mathcal{P} : \langle v,w\rangle = 0 \text{ for all }w\in\mathcal{C} \}, \]
		where
		\[ \langle v , w \rangle = \sum_{x \in \mathcal{P}} v_x w_x.  \]
	\end{fdef}
	Observe that perhaps counter to one's intuition, a code and its dual need not be disjoint.\\
	If the dual of a code over $\F_q$ contains a non-zero vector, then the code is non-trivial at $q$.\\

	We are interested in the \emph{weight} of the codes $\mathcal{C}_q(\mathcal{X})$ and $\mathcal{C}_q(\mathcal{X})^\top$ for projective planes or partial linear spaces $\mathcal{X}$ (typically of prime order).

\subsection{Rigidity Theorems on Partial Linear Spaces}

	\begin{fdef}[Induced structure]
		Given a partial linear space $(\mathcal{P},\mathcal{L})$ and a $\mathcal{P}' \subseteq \mathcal{P}$ such that no line in $\mathcal{L}$ intersects $\mathcal{P}'$ in exactly one point, one can easily come up with a partial linear space $(\mathcal{P}',\mathcal{L}')$ by restricting to those lines in $\mathcal{L}$ which intersect $\mathcal{P}'$. This is known as the \emph{induced structure} on $\mathcal{P}'$.
	\end{fdef}

	\begin{fdef}[Join]
		Given two partial linear spaces $(\mathcal{P}_1,\mathcal{L}_1)$ and $(\mathcal{P}_2,\mathcal{L}_2)$ with $\mathcal{P}_1 \cap \mathcal{P}_2 = \emptyset$, one can define the \emph{join} of the two partial linear spaces by $(\mathcal{P}_1 \cup \mathcal{P}_2, \mathcal{L}_1\cup\mathcal{L}_2\cup\mathcal{L}_3)$, where
		\[ \mathcal{L}_3 = \{ \{x,y\} : x \in \mathcal{P}_1, y \in \mathcal{P}_2 \}. \]
	\end{fdef}

	\begin{ftheo}
		If a PLS $\mathcal{X} = (\mathcal{P},\mathcal{L})$ is non-trivial at $p$ and has at least $n+1$ lines through every point, then $|\mathcal{P}| \ge 2n+2-2n/p$. Moreover, equality holds iff $\mathcal{X}$ is the join of two Steiner $2$-designs with $n/p$ lines through each point and $p$ points on each line.
	\end{ftheo}
	\begin{proof}
		The backward direction of the iff statement is direct since each of the Steiner designs has $n - (n/p - 1)$ points and their join thus has $2n+2-2n/p$ points. Similarly, there are $n/p + (n - n/p + 1) = n+1$ lines through each point in the join.\\
		
		The converse is trivial for $p = 2$, so assume $p > 2$. \\
		Let $(\mathcal{P}',\mathcal{L}')$ be a PLS which is non-trivial at $p$, has at least $n+1$ lines through every point, and with $|\mathcal{P}'| \le 2n+2-2n/p$. Denote $\mathcal{C} = \mathcal{C}_p(\mathcal{X})$. Let $w$ be a word of minimum weight in $\mathcal{C}^\top$, and $\mathcal{P}$ be the support of $w$ (the set of coordinates where $w$ is nonzero). Let $(\mathcal{P},\mathcal{L}_0)$ be the induced structure on $\mathcal{P}$ -- it is a partial linear space such that $\mathcal{C}_{\mathcal{L}_0}^\top$ is generated by the restriction of $w$ to $\mathcal{P}$. Obviously, $(\mathcal{P},\mathcal{L})$ is non-trivial at $p$, and a subset $\ell$ of $\mathcal{P}$ is in $\mathcal{L}_0$ iff its characteristic function is in the dual of $\langle w \rangle$.\\
		Now, repeatedly perform the following sequence of operations on $\mathcal{L}_0$ until it is no longer possible to do so:
		\begin{enumerate}
			\item Choose $\ell \in \mathcal{L}_0$ that can be written as $\ell = \ell' \cup \ell''$, where $\ell'$ (and so $\ell''$) is in $\mathcal{C}_{\mathcal{L}_0}$.
			\item Replace $\ell$ with $\ell'$ and $\ell''$.
		\end{enumerate}
		Finally, we have a set of lines in $\mathcal{P}$ such that no proper subset of a line is in $\mathcal{C}_{\mathcal{L}_0}$. Let this new set of lines be $\mathcal{L}$ (this is not uniquely defined). $(\mathcal{P},\mathcal{L})$ satisfies the following properties.
		\begin{itemize}
			\item[(a)] There are at least $n+1$ lines through every point.
			\item[(b)] $\mathcal{C}_{\mathcal{L}} = \mathcal{C}_{\mathcal{L}_0}$.
			\item[(c)] $\mathcal{C}_{\mathcal{L}}$ does not contain the characteristic function of a proper non-empty subset of any line in $\mathcal{L}$.
			\item[(d)] $\mathcal{C}_{\mathcal{L}}$ is one-dimensional and $\mathcal{P}$ is the support of its generator $w$.
		\end{itemize}

		\textbf{Claim.} Denote by $\mathcal{X} = (\mathcal{P}'',\mathcal{L}'')$ the join of two Steiner designs of the given form. $(\mathcal{P}',\mathcal{L}')$ is isomorphic to $\mathcal{X}$ if and only if $(\mathcal{P},\mathcal{L})$ is isomorphic to $\mathcal{X}$.\\
		The forward direction of the above is obvious. For the converse, let us show that $(\mathcal{P},\mathcal{L}) = (\mathcal{P}',\mathcal{L}')$. Since
		\[ 2n + 2 - \frac{2n}{p} = |\mathcal{P}| \le |\mathcal{P'}| \le 2n + 2 - \frac{2n}{p}, \]
		$\mathcal{P} = \mathcal{P}'$.\\
		Note that $(\mathcal{P},\mathcal{L})$ is a linear space. If we had replaced any line with its partition when going from $\mathcal{L}_0$ to $\mathcal{L}$, then this would not have been possible. Indeed, if there was a line $\ell \ni x,y$ replaced with $\ell,\ell'$ such that $x \in \ell$, $y \in \ell'$, then there would be no line incident on both $x$ and $y$, contradicting the fact that $(\mathcal{P},\mathcal{L})$ is a linear space. More generally, this implies that if we apply the partitioning process described above, then the second PLS being a linear space implies that both PLSes are equal. \\
		Therefore, $(\mathcal{P},\mathcal{L})$ is isomorphic to $(\mathcal{P}',\mathcal{L}')$. \qedwhite \\

		For the rest of the proof, we work with this PLS.\\
		For each $P \in \mathcal{P}$, let $x_P,y_P,z_P$ be number of lines through $P$ of cardinalities $2,3,4$ respectively. Fix $Q \in \mathcal{P}$ of minimal $x_Q$. Now, colour $\mathcal{P}$ with $\F_p$, by colouring each point $P$ as $w_P$ (the $P$th coordinate). Assume that $Q$ is coloured $-1$.\\
		Since any line is in the dual of $\langle w \rangle$, the sum of colours on any line is $0$ modulo $p$.\\
		By property (c), the colours of any non-empty proper subset of a line do not add to $0$ modulo $p$.\\
		Therefore, the lines of size $2$ are precisely those that have colours $\alpha$ and $-\alpha$ (for some $\alpha \in \F_p^\times$) and any monochromatic line has length $p$.\\
		Let $\mathcal{S}$ be the set of all used colours (all the values in $\F_p$ that are equal to some $w_P$). Further, $0 \not\in \mathcal{S}$ since $w_P \ne 0$ for any $P \in \mathcal{P}$. Then, letting $S_P$ be the set of all points that are on a line passing through $P$, we can use the fact that there is at most one line passing through a pair of distinct points to conclude that
		\[ 1 + x_P + 2 y_P + 3 z_P + 4(n+1 - x_P - y_P - z_P) \le |S_P| \le 2n+2-\frac{2n}{p}, \]
		so
		\begin{equation}
			\label{eqn: xP yP zP joint bound}
			2n+3+\frac{2n}{p} \le 3 x_P + 2 y_P + z_P.
		\end{equation}
		Similarly, applying this to only $x_P$ and $y_P$, we get
		\begin{equation}
			\label{eqn: xP yP joint bound}
			n+2+\frac{2n}{p} \le 2x_P + y_P.
		\end{equation}
		Let $\ell_1,\ell_2,\ldots,\ell_m$ be all the lines through $P$ of cardinality at least $4$. Then,
		\[ |S_A| \ge 1 + x_P + 2(n+1 - x_P - m) + \sum_{i = 1}^{m} (|\ell_i| - 1) \]
		and so,
		\begin{equation}
			\label{eqn: xP line bound}
			x_P \ge 1 + \frac{2n}{p} + \sum_{i=1}^{m} (|\ell_i| - 3) \ge 1 + \frac{2n}{p}.	
		\end{equation}
		% Why is x_Q > 0?
		Since the number of size $2$ lines through any point is at least $x_Q$, for any $\alpha \in \mathcal{S}$, there are at least $x_Q$ points of colour $-\alpha$. Because $x_Q > 0$ by \Cref{eqn: xP line bound}, this implies that $\alpha \in \mathcal{S}$ iff $-\alpha \in \mathcal{S}$, and this together with $0 \not\in \mathcal{S}$ implies that $|\mathcal{S}|$ is even, say $2r$ for some $0 < r \le (p-1)/2$. As there are at least $x_Q$ points of any colour $\alpha \in \mathcal{S}$,
		\begin{equation}
			\label{eqn: xQ bound}
			r x_Q \le n + 1 - \frac{n}{p}.	
		\end{equation}
		This together with the previous equation yields that
		\[ r \le \frac{n+1 - n/p}{1 + 2n/p} < \frac{p-1}{2}, \]
		where the second inequality uses the fact that $p \ge 3$. Therefore, $|\mathcal{S}| < p-1$.\\


		\textbf{Claim.} If $r = 1$, then $|\mathcal{P}| = 2n+2-2n/p$ and $(\mathcal{P},\mathcal{L})$ is isomorphic to the join of two Steiner 2-designs of the described form.\\
		As $r=1$, $\mathcal{S} = \{-1,1\}$ and any line is of size either $2$ or $p$. Let $X_i$ be the number of points of colour $i$ for $i \in \mathcal{S}$. Since the number of size $2$ lines through any $P$ of colour $i$ is at most $|X_{-i}|$, $|x_Q| \le n+1-n/p$. Consequently, letting $S_Q$ be all the points that are on a line through $Q$,
		\[ 2n+2-\frac{2n}{p} \ge |S_Q| \ge 1 + \underbrace{(p-1) \frac{n}{p}}_{\text{$p$-lines through $Q$}} + \underbrace{\left(n+1-\frac{n}{p}\right)}_{\text{$2$-lines through $Q$}} = 2n+2-\frac{2n}{p},  \]
		so $x_Q = n+1-n/p$, there are precisely $n/p$ lines through $Q$, and $|S_Q| = 2n+2-2n/p$. This implies that $|X_1| = |X_{-1}| = n+1-n/p$, and so that the number of size $2$ lines (resp. size $p$ lines) through any $A$ is exactly $n+1-n/p$ (resp. $n/p$).\\
		Each of the two $X_i$s is isomorphic to a Steiner $2$-design with $n/p$ lines through each point and $p$ points on each line, so $(\mathcal{P},\mathcal{L})$ is isomorphic to the join of two Steiner $2$-designs of the prescribed form. \qedwhite\\

		Now, consider the case where $r\ge2$. We shall show that this situation cannot occur at all.\\ 
		Consider the graph $G_Q$ with vertex set $\mathcal{S}$ where $\alpha,\beta$ are adjacent iff $\alpha+\beta$ is equal to $0$ or $1$ (in $\F_p$). Note that for any $\alpha \in \mathcal{S}$ of degree $1$ and $3$-line $L$ through $Q$, $L \cap X_\alpha$ is either empty or equal to $\{Q\}$ (in the case where $\alpha = -1$). In particular, the degree of $1$ in $G_Q$ is one so no $3$-line passes through a point of colour $1$.\\

		\textbf{Claim.} $G_Q$ is acyclic.\\
		The only possible loop (edge from a vertex to itself) is at $(p+1)/2$. Consider a cycle $\alpha_1\alpha_2\cdots\alpha_m\alpha_1$. $m$ must be even since the two types of edges alternate. This pattern of edges also implies that $m$ is a multiple of $2p$ (consider the sum of all $\alpha_i$). However, this is not possible since $m \le |\mathcal{S}| < p-1$, so $G_Q$ contains no cycles. Any connected component of $G_Q$ is a path, with possibly a loop at one end due to $(p+1)/2$. \qedwhite\\

		\textbf{Claim.} $G_Q$ is not connected.\\
		Suppose instead that $G_Q$ is connected. By the previous claim, it is then just a path. If $1$ is the only vertex of degree one, then this path is equal to $1(-1)2(-2)\cdots (\frac{p-1}{2})(\frac{p+1}{2})$ since there must be a loop at the other end. In this case however, $|\mathcal{S}| = p-1$, which is not possible. So, there is another $-r \in \mathcal{S}$ of degree one, and the path is of the form $1 (-1) 2 (-2) \cdots r (-r)$ for $1 < r < (p-1)/2$.\\
		Let $T = \mathcal{P} \setminus (\{Q\} \cup X_{-r})$. Since $r > 1$,
		% \begin{equation}
		% 	\label{eqn: size T upper bound}
		\[ |T| \le 2n + 2 - \frac{2n}{p} - (1 + x_Q). \]
		% \end{equation}
		Let $l$ be the number of lines through $Q$ of size $>2$ that contain at most one point from $T$. Observe that any size $2$ line through $Q$ has exactly one point from $T$. Counting points in $T$ that lie on lines through $Q$,
		\[ |T| \ge 2 (n+1 - x_Q - l) + x_Q. \]
		Combining the above two equations,
		\[ l \ge \frac{n}{p} + \frac{1}{2} > \frac{n}{p}. \]
		Let $\ell$ be such a line. We now use the fact that the sum of colours on a line is $0$. \\
		If $\ell \cap T = \emptyset$, then it contains at least $(p-1)/r$ points from $X_{-r}$ and thus at least $(p+r-1)/r$ points in all. \\
		If $\ell$ does contain one point from $T$, then the colour of this point is $1 + (|\ell|-2)r$ modulo $p$. \\
		If $1 + (|\ell|-2)r$ is greater than $p$ (as a number), then $|\ell| \ge 2 + (p-1)/r \ge (p+r-1)/r$. Otherwise, we must have that this number is itself in $\mathcal{S}$. Since $|\ell| > 2$, this number is greater than $r$ so must be in $\{p-r,\ldots,p-1\}$. That is, $1 + (\ell-2)r \ge p-r$. This yields once more that $|\ell| \ge (p+r-1)/r$.\\
		Since $r < (p-1)/2$, $|\ell| > 3$. Thus, we can use \Cref{eqn: xP line bound} to get that
		\[ x_Q > 1 + \frac{2n}{p} + \frac{n}{p} \left( \frac{p+r-1}{r} - 3 \right) = 1 + \frac{n}{r} - \frac{n}{pr}, \]
		which contradicts \Cref{eqn: xQ bound}. \qedwhite \\

		Thus, suppose that $G_Q$ is disconnected. Let $\mathcal{S}' \subseteq \mathcal{S}$ be the set of all degree one colours. As $G_Q$ is disconnected, $|\mathcal{S}'| \ge 3$.\\
		Consider the set of points in $\mathcal{P} \setminus \{Q\}$ that are on size $3$ lines through $Q$. This set is of size $2y_Q$, and does not intersect any $X_\alpha$ for $\alpha \in \mathcal{S}'$. Therefore,
		\begin{equation}
			\label{eqn: xQ yQ joint bound 2}
			2n + 2 - \frac{2n}{p} \ge 2 y_Q + |\mathcal{S}'| x_Q.
		\end{equation}
		We may then use \Cref{eqn: xP yP joint bound} to conclude that $|\mathcal{S}'| < 4$, and is so exactly $3$.\\
		Combining \Cref{eqn: xP yP joint bound,eqn: xQ yQ joint bound 2}, $x_Q \ge 2 + 6n/p$, and $r = |\mathcal{S}|/2$ is $< p/6$.\\
		$G_Q$ has two connected components of the form
		\[ 1 (-1) 2 (-2) \cdots t (-t) \]
		for some $1 \le t < r$ and
		\[ \left( \frac{p+1}{2} \right) \left( \frac{p-1}{2} \right) \left( \frac{p+3}{2} \right) \left( \frac{p-3}{2} \right) \cdots \left( \frac{p+1}{2} - (r-t) \right), \]
		with the vertices of degree $1$ being $1$, $-t$ and $\alpha = (p+1)/2 - (r-t)$. Consider
		\[ T = \{Q\} \cup X_{-t} \cup X_\alpha \cup \mathcal{P}_2 \cup \mathcal{P}_3, \]
		where $\mathcal{P}_i$ is the set of points in $\mathcal{P} \setminus \{Q\}$ that are on size $i$ lines through $Q$. We have that
		\[ |T| \ge 3x_Q + 2y_Q. \]
		If every size $4$ line through $Q$ intersects $\mathcal{P} \setminus T$,
		\[ 2n + 2 - \frac{2n}{p} \ge z_Q + |T| \ge z_Q + 2y_Q + 3x_Q, \]
		which contradicts \Cref{eqn: xP yP zP joint bound}. Therefore, there exists a size $4$ line $\ell$ through $Q$ contained in $T$. Further, since there is at most one line incident on a pair of points, $\ell \subseteq \{Q\} \cup X_{-t} \cup X_\alpha$.\\
		If $\ell$ contains $0 \le i \le 3$ points from $X_\alpha$, then the sum of colours of $\ell$ is $-1 + (-t)(3-i) + \alpha i$. This must be a multiple of $p$. Substituting each of the values of $i$, this is one of
		\[ 3t+1,\quad 2(r+t)+1,\quad 2r-t,\quad 6(r-t)-1, \]
		none of which can be a multiple of $p$ since $1 \le t < r < p/6$, completing the proof.
	\end{proof}

\subsection{Combinatorial Nullstellensatz}

	The reader is likely familiar with the following famous theorem.

	\begin{ftheo}[Hilbert's Nullstellensatz]
		Let $\F$ be an algebraically closed field and $f,g_1,\ldots,g_m$ be elements of the ring $\F[x_1,\ldots,x_n]$ of polynomials such that $f$ vanishes on all common zeroes of the $(g_i)$. Then, there is an integer $k$ and polynomials $h_1,\ldots,h_m$ in $\F[x_1,\ldots,x_n]$ such that
		\[ f^k = \sum_{i=1}^{m} g_i h_i. \]
	\end{ftheo}

	Before we get to the main result of this section which is essentially an interesting form of the above when the $g_i$ take a specific form, we give a lemma related to the size of a `cube' required to evaluate a polynomial at to determine if it is the $0$ polynomial.

	\begin{lemma}
		\label{lem: comb null lem}
		Let $P = P(x_1,\ldots,x_n)$ be a polynomial over a(n arbitrary) field $\F$. Suppose that for each $i$, $S_i \subseteq \F$ with $|S_i| > \deg_i(P)$. If $P(s_1,\ldots,s_n) = 0$ for all choices of $s_i \in S_i$ for each $i$, then $P$ is identically $0$. 
	\end{lemma}
	\begin{proof}
		We prove this by induction on $n$. When $n=1$, this is direct as it merely states that a polynomial of degree at most $t$ has at most $t$ zeroes. Suppose that the statement is true for $n-1$. Let $t_i = \deg_i(P)$ for each $i$. Write $P$ as a sum
		\[ P = \sum_{i=0}^{t_i} x_n^i P_i(x_1,\ldots,x_{n-1}), \]
		where each $P_i$ is a polynomial with $\deg_j$ bounded above by $t_j$. Observe that for any fixed tuple $(x_1,\ldots,x_{n-1}) \in S_1 \times \cdots \times S_{n-1}$, the polynomial obtained from $P$ by substituting the values of $x_1,\ldots,x_{n-1}$ vanishes on $S_n$, and thus by the $n=1$ case, is identically zero. Therefore, each $P_i$ vanishes on $S_1 \times \cdots \times S_{n-1}$. Applying the inductive hypothesis, each $P_i$ is thus identically $0$, yielding that $P$ is identically $0$ and completing the proof.
	\end{proof}

	Later in \Cref{thm: cube-vanishing}, we give a much stronger version of this

	\begin{ftheo}[Combinatorial Nullstellensatz]
		\label{thm: comb null}
		Let $\F$ be an algebraically closed field and $S_1,\ldots,S_n \subseteq \F$. Define
		\[ g_i(x_i) = \prod_{s_i \in S_i} (x_i - s_i) \]
		for each $i$. Let $f \in \F[x_1,\ldots,x_n]$ vanish on all common zeroes of the $(g_i)$, that is, $f(s_1,\ldots,s_n) = 0$ if $s_i \in S_i$ for each $i$. Then, there are polynomials $h_1,\ldots,h_n$ in $\F[x_1,\ldots,x_n]$ such that
		\[ f = \sum_{i=1}^{m} g_i h_i. \]
		and $\deg(h_i) \le \deg(f) - \deg(g_i)$ for each $i$.\\
		Moreover, if $f,g_1,\ldots,g_n \in R[x_1,\ldots,x_n]$ for some subring $R$ of $\F$, then there are polynomials $h_i \in R[x_1,\ldots,x_n]$ satisfying the above.
	\end{ftheo}
	\begin{proof}
		Let $t_i = |S_i| - 1$ for each $i$. For each $i$, write $g(x_i) = x_i^{t_i+1} - g_0(x_i)$ -- note that $g_0$ is a polynomial of degree at most $t_i$. For each $x_i \in S_i$, we then have
		\[ x_i^{t_i + 1} = g_0(x_i). \]
		Now, take the polynomial $f$ and subtract polynomials of the form $h_i g_i$, each of which replaces the higher degree terms of $x_i$ (terms with $x_i^{r}$ for $r > t_i$) with a lower degree one using the above equation, to get a polynomial $f_0$. Observe that this polynomial $f_0$ vanishes on $S_1 \times \cdots \times S_n$, and $\deg_i(f_0) \le t_i$ for each $i$. We can then use \Cref{lem: comb null lem} to conclude that $f_0$ is identically zero, and thus that $f$ is equal to $\sum_i h_i g_i$, completing the proof.
	\end{proof}

	The simple proof above betrays the surprising usefulness of this result.

	\begin{fcor}
		\label{thm: cube-vanishing}
		Let $P = P(x_1,\ldots,x_n)$ be a polynomial over a(n arbitrary) field $\F$. Let $\deg(f) = \sum_i t_i$, and let there exist a $x_1^{t_1} x_2^{t_2} \cdots x_n^{t_n}$ term in the polynomial with non-zero coefficient. Suppose that for each $i$, $S_i \subseteq \F$ with $|S_i| > t_i$. If $P(s_1,\ldots,s_n) = 0$ for all choices of $s_i \in S_i$ for each $i$, then $P$ is identically $0$. 
	\end{fcor}
	\begin{proof}
		Let us assume that $|S_i| = t_i + 1$ for each $i$.\\
		Suppose that the claim does not hold and let $g_i(x_i) = \prod_{s_i \in S_i} (x_i - s_i)$ for each $i$. \nameref{thm: comb null} then implies that
		\[ P = \sum_i h_i g_i \]
		for polynomials $h_i$ of degree at most $\deg(f) - \deg(g_i)$. Now, any monomial of degree $\deg(f)$ must come from one of the $h_i g_i$. However, any term in these polynomials are divisible by $x_i^{|S_i|} = x_i^{t_i + 1}$, which implies that there is no $x_i^{t_i}$ term in $P$, yielding a contradiction and completing the proof.
	\end{proof}